<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
  <script src="../src/Routes/visitor.js"></script>
    <title>Page count</title>
</head>
<body class="bg-lime-200">
    <div class="flex justify-center items-center text-center font-bold mt-12">
        <h1>This is an API generated by me to check count the number of visitors</h1>
    </div>
    <div class=" bg-white flex justify-center items-center h-36 text-black mt-10 mb-10 shadow-xl w-96 font-semibold mx-96" id="container">
  <div class="flex flex-row justify-center items-center mt-10 mb-10 mb px-10 w-80 h-10 ">
    <span   id="pageviews-count"></span>
    <h4>Pageviews</h4>
  </div>
  <div class= "flex flex-row  justify-center items-center mt-10 mb-10  px-10 w-80 h-10 " >
    <span id="visits-count"></span>
    <h4>Visits</h4>
  </div>
</div>
<script>
    const pageviewsCount = document.getElementById('pageviews-count');
const visitsCount = document.getElementById('visits-count');

if (sessionStorage.getItem('visit') === null) {
  // New visit and pageview
  updateCounter('type=visit-pageview');
} else {
  // Pageview
  updateCounter('type=pageview');
}

function updateCounter(type) {

  fetch('http://localhost:3000/visitor/api?'+type) // Dynamic request with URL parameter
    .then(res => res.json())
    .then(data => {
      pageviewsCount.textContent = data.pageviews; // Display pageviews to user
      visitsCount.textContent = data.visits; // Display visits to user
    })

}

sessionStorage.setItem('visit', 'x');
// 'visit' item persists in storage for the remainder of the user session
</script>
</body>
</html>